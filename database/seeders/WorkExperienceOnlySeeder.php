<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Maid;
use App\Models\WorkExperience;
use Carbon\Carbon;

class WorkExperienceOnlySeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        echo "ุจุฏุก ุฅุถุงูุฉ ุฎุจุฑุงุช ุงูุนูู ููุฎุงุฏูุงุช ุงูููุฌูุฏุฉ...\n\n";

        // ูุงุฆูุฉ ุฎุจุฑุงุช ุงูุนูู ุงูููููุฉ
        $workExperiences = [
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุณุนูุฏ',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2 ุณูุฉ',
                'start_date' => '2022-01-01',
                'end_date' => '2024-01-01',
                'description' => 'ุนููุช ูุฎุงุฏูุฉ ููุฒููุฉ ูู ุนุงุฆูุฉ ููููุฉ ูู 4 ุฃูุฑุงุฏุ ูุณุคููุฉ ุนู ุงูุชูุธูู ูุงูุทุจุฎ ูุฑุนุงูุฉ ุงูุฃุทูุงู.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงููุญููุฏ',
                'position' => 'ูุฑุจูุฉ ุฃุทูุงู',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '3 ุณููุงุช',
                'start_date' => '2019-03-15',
                'end_date' => '2022-03-15',
                'description' => 'ูุชุฎุตุตุฉ ูู ุฑุนุงูุฉ ุงูุฃุทูุงู ูู ุณู 2-8 ุณููุงุชุ ูุณุงุนุฏุฉ ูู ุงููุงุฌุจุงุช ุงููุฏุฑุณูุฉ ูุงูุฃูุดุทุฉ ุงูุชุฑููููุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุฑุดูุฏ',
                'position' => 'ุทุจุงุฎุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2.5 ุณูุฉ',
                'start_date' => '2021-06-01',
                'end_date' => '2024-01-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุงูุทุจุฎ ุงูุนุฑุจู ูุงูููุฏูุ ุฅุนุฏุงุฏ ูุฌุจุงุช ุตุญูุฉ ููุชููุนุฉ ููุนุงุฆูุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูููุฏู',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '4 ุณููุงุช',
                'start_date' => '2018-09-01',
                'end_date' => '2022-09-01',
                'description' => 'ุฎุจุฑุฉ ุทูููุฉ ูู ุฅุฏุงุฑุฉ ุงูููุฒูุ ุชูุธูู ุดุงููุ ุบุณูู ููู ุงูููุงุจุณุ ุชุฑุชูุจ ุงูููุฒู.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุฒูุฑุงูู',
                'position' => 'ููุฏูุฉ ุฑุนุงูุฉ ูููุณููู',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2 ุณูุฉ',
                'start_date' => '2020-11-01',
                'end_date' => '2022-11-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุฑุนุงูุฉ ูุจุงุฑ ุงูุณูุ ูุณุงุนุฏุฉ ูู ุงูุฃุฏููุฉ ูุงูุชูุงุฑูู ูุงูุฃูุดุทุฉ ุงูููููุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงููุญุทุงูู',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '3 ุณููุงุช',
                'start_date' => '2019-04-15',
                'end_date' => '2022-04-15',
                'description' => 'ุนููุช ูู ููุฒู ูุจูุฑ ูููู ูู ุทุงุจูููุ ูุณุคููุฉ ุนู ุงูุชูุธูู ุงููููู ูุฅุนุฏุงุฏ ุงููุฌุจุงุช.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุดูุฑู',
                'position' => 'ุฌููุณุฉ ุฃุทูุงู',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '1.5 ุณูุฉ',
                'start_date' => '2022-07-01',
                'end_date' => '2024-01-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุฑุนุงูุฉ ุงูุฃุทูุงู ุงูุฑุถุน ูุงูุฃุทูุงู ุงูุตุบุงุฑุ ุฎุจุฑุฉ ูู ุชุบููุฑ ุงูุญูุงุถุงุช ูุงูุฑุถุงุนุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงููุทูุฑู',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2 ุณูุฉ',
                'start_date' => '2021-01-01',
                'end_date' => '2023-01-01',
                'description' => 'ุนููุช ูู ุนุงุฆูุฉ ุตุบูุฑุฉุ ูุณุคููุฉ ุนู ุฌููุน ุงูุฃุนูุงู ุงูููุฒููุฉ ูุงูุทุจุฎ ุงูุจุณูุท.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุนุชูุจู',
                'position' => 'ุทุจุงุฎุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '3 ุณููุงุช',
                'start_date' => '2020-02-01',
                'end_date' => '2023-02-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุงูุทุจุฎ ุงูุนุฑุจู ุงูุฃุตููุ ุฅุนุฏุงุฏ ุงูุฃุทุจุงู ุงูุชูููุฏูุฉ ูุงููุฌุจุงุช ุงูุตุญูุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุบุงูุฏู',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2.5 ุณูุฉ',
                'start_date' => '2021-08-01',
                'end_date' => '2024-02-01',
                'description' => 'ุฎุจุฑุฉ ูู ุชูุธูู ุงูููุงุฒู ุงููุจูุฑุฉุ ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุชูุธูู ุงูุญุฏูุซุฉุ ุชูุธูู ุงูููุฒู.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุญุฑุจู',
                'position' => 'ูุฑุจูุฉ ุฃุทูุงู',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '4 ุณููุงุช',
                'start_date' => '2018-12-01',
                'end_date' => '2022-12-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุฑุนุงูุฉ ุงูุฃุทูุงู ูู ุงููุฑุญูุฉ ุงูุงุจุชุฏุงุฆูุฉุ ูุณุงุนุฏุฉ ูู ุงููุงุฌุจุงุช ูุงูุฃูุดุทุฉ ุงูุชุนููููุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงููุนููู',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2 ุณูุฉ',
                'start_date' => '2022-03-01',
                'end_date' => '2024-03-01',
                'description' => 'ุนููุช ูู ุดูุฉ ุตุบูุฑุฉุ ูุณุคููุฉ ุนู ุงูุชูุธูู ุงููููู ูุงูุทุจุฎ ุงูุจุณูุท.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุฏูุณุฑู',
                'position' => 'ููุฏูุฉ ุฑุนุงูุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '3 ุณููุงุช',
                'start_date' => '2020-05-01',
                'end_date' => '2023-05-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุฑุนุงูุฉ ูุจุงุฑ ุงูุณู ูุงูุฃุทูุงูุ ุฎุจุฑุฉ ูู ุชูุฏูู ุงูุฏุนู ุงูููุณู ูุงูุฌุณุฏู.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุจููู',
                'position' => 'ุฎุงุฏูุฉ ููุฒููุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2 ุณูุฉ',
                'start_date' => '2021-10-01',
                'end_date' => '2023-10-01',
                'description' => 'ุนููุช ูู ููุฒู ุญุฏูุซุ ุงุณุชุฎุฏุงู ุฃุญุฏุซ ุฃุฏูุงุช ุงูุชูุธูู ูุงูุชูููุงุช ุงูููุฒููุฉ.',
            ],
            [
                'company_name' => 'ุนุงุฆูุฉ ุงูุฌููู',
                'position' => 'ุทุจุงุฎุฉ',
                'country' => 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
                'work_type' => 'ุนูุฏ ุณูุชูู',
                'duration' => '2.5 ุณูุฉ',
                'start_date' => '2021-03-01',
                'end_date' => '2023-09-01',
                'description' => 'ูุชุฎุตุตุฉ ูู ุงูุทุจุฎ ุงูุตุญู ูุงููุฌุจุงุช ุงูุบุฐุงุฆูุฉ ุงููุชูุงุฒูุฉุ ุฎุจุฑุฉ ูู ุงูุทุจุฎ ุงููุจุงุชู.',
            ],
        ];

        // ุงูุญุตูู ุนูู ุฌููุน ุงูุฎุงุฏูุงุช
        $maids = Maid::all();

        if ($maids->count() == 0) {
            echo "ูุง ุชูุฌุฏ ุฎุงุฏูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช!\n";
            return;
        }

        $addedCount = 0;
        $skippedCount = 0;

        foreach ($maids as $maid) {
            // ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฎุจุฑุงุช ุนูู ูุณุจูุงู
            if ($maid->workExperiences()->count() == 0) {
                // ุงุฎุชูุงุฑ ุฎุจุฑุฉ ุนูู ุนุดูุงุฆูุฉ ุฃู ูุชุนุฏุฏุฉ
                $numberOfExperiences = rand(1, 3); // ูู 1 ุฅูู 3 ุฎุจุฑุงุช
                $selectedExperiences = array_rand($workExperiences, min($numberOfExperiences, count($workExperiences)));
                
                // ุงูุชุฃูุฏ ูู ุฃู $selectedExperiences ูู array
                if (!is_array($selectedExperiences)) {
                    $selectedExperiences = [$selectedExperiences];
                }

                $totalYears = 0;

                foreach ($selectedExperiences as $index) {
                    $experience = $workExperiences[$index];
                    
                    // ุฅูุดุงุก ุฎุจุฑุฉ ุนูู ุฌุฏูุฏุฉ
                    WorkExperience::create([
                        'maid_id' => $maid->id,
                        'company_name' => $experience['company_name'],
                        'position' => $experience['position'],
                        'country' => $experience['country'],
                        'work_type' => $experience['work_type'],
                        'duration' => $experience['duration'],
                        'start_date' => Carbon::parse($experience['start_date']),
                        'end_date' => Carbon::parse($experience['end_date']),
                        'description' => $experience['description'],
                    ]);

                    // ุญุณุงุจ ุณููุงุช ุงูุฎุจุฑุฉ
                    $duration = $experience['duration'];
                    preg_match('/(\d+(?:\.\d+)?)/', $duration, $matches);
                    if (isset($matches[1])) {
                        $totalYears += floatval($matches[1]);
                    }
                }

                // ุชุญุฏูุซ ุณููุงุช ุงูุฎุจุฑุฉ ูู ุฌุฏูู ุงูุฎุงุฏูุงุช
                $maid->update([
                    'experience_years' => round($totalYears, 1)
                ]);

                echo "โ ุชู ุฅุถุงูุฉ " . count($selectedExperiences) . " ุฎุจุฑุฉ ุนูู ููุฎุงุฏูุฉ: " . $maid->name . " (ุณููุงุช ุงูุฎุจุฑุฉ: " . round($totalYears, 1) . ")\n";
                $addedCount++;
            } else {
                echo "โญ๏ธ  ุงูุฎุงุฏูุฉ " . $maid->name . " ูุฏููุง ุฎุจุฑุงุช ุนูู ุจุงููุนู (" . $maid->workExperiences()->count() . " ุฎุจุฑุฉ)\n";
                $skippedCount++;
            }
        }

        echo "\n๐ ููุฎุต ุงูุนูููุฉ:\n";
        echo "โ ุชู ุฅุถุงูุฉ ุฎุจุฑุงุช ุนูู ูู " . $addedCount . " ุฎุงุฏูุฉ\n";
        echo "โญ๏ธ  ุชู ุชุฎุทู " . $skippedCount . " ุฎุงุฏูุฉ (ูุฏููุง ุฎุจุฑุงุช ุจุงููุนู)\n";
        echo "๐ ุชู ุงูุงูุชูุงุก ูู ุฅุถุงูุฉ ุฎุจุฑุงุช ุงูุนูู ููุฎุงุฏูุงุช!\n\n";
    }
}
